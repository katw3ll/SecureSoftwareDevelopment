# SAST

## Шаг 1. Анализ в SonarCloud

<img width="1440" alt="Снимок экрана 2021-11-29 в 11 03 03" src="https://user-images.githubusercontent.com/25080506/143830105-712e257a-2668-4776-85f8-a2ae169b781d.png">

## Шаг 2. Анализ ошибок в коде

Значение GET параметра 'id' никаким образом не проверяется перед добавление его в SQL запрос:

> $id = $_GET[ 'id' ];

Оно записывается в переменную `$id`, далее с помощью этой переменной формируется запрос и успешно выполняется на стороне сервера:

> $getid  = "SELECT first_name, last_name FROM users WHERE user_id = '$id';";
> 
> $result = mysqli_query($GLOBALS["___mysqli_ston"],  $getid );

Отсюда возникает код уязвимый к SQL-инъекциям

## Шаг 3. Исправление ошибок в коде

1. Добавлено использование технология PDO (PHP Data Objects — расширение для PHP, предоставляющее разработчику универсальный интерфейс для доступа к различным базам данных)
2. Добавлено использование функции `is_numeric()` для проверки вводимого значения `id`
3. Добавлен код для защиты от CSRF атак. Теперь пользватель отправляет запрос с токеном, который не позволит выполнить поддельные запросы

Исправленный вариант: `submit_fixed.php`

<img width="1440" alt="Снимок экрана 2021-11-29 в 11 38 48" src="https://user-images.githubusercontent.com/25080506/143834700-88f386dd-15e6-4461-8f36-3f9a51a6fb0f.png">

