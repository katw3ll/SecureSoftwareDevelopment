# Code Review

`CWE-598`: Использование метода запроса GET с чувствительными строками запроса

> $user = $_GET[ 'username' ];

> $pass = $_GET[ 'password' ];

Исправление: При отправке конфиденциальной информации необходимо использовать метод POST

========================================================================================

`CWE-327`: Использование устаревшего криптографического алгоритма MD5
+ `CWE-759`: Использование одностороннего хеширования без соли 

> $pass = md5( $pass );

Исправление: Использовать более криптостойкий пароль - SHA256. Также использовать соль, которая будет храниться в базе данных.

========================================================================================

`CWE-759`: Использование одностороннего хеширования без соли

Исправление: Добавить в генерацию паролей дополнительную соль.

========================================================================================

`CWE-89`: Неправильная нейтрализация специальных элементов, используемых в команде SQL

> $query  = "SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';";

Исправление: добавить использование PDO или его аналогов, чтобы избежать SQL инъекции.

========================================================================================

`CWE-307`: Неправильное ограничение или отсутствия чрезмерных попыток аутентификации

```
...
$result = mysqli_query($GLOBALS["___mysqli_ston"],  $query ) or die( '<pre>' . ((is_object($GLOBALS["___mysqli_ston"])) ? mysqli_error($GLOBALS["___mysqli_ston"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );

if( $result && mysqli_num_rows( $result ) == 1 ) {

... 

```

Возможные варианты исправления ошибок:
 - Отключение пользователя после небольшого количества неудачных попыток
 - Реализация тайм-аута
 - Блокировка целевой учетной записи
 - Требование вычислительной задачи со стороны пользователя.

========================================================================================

  
